<HTML>
<CENTER><A HREF = "http://spparks.sandia.gov">SPPARKS WWW Site</A> - <A HREF = "Manual.html">SPPARKS Documentation</A> - <A HREF = "Section_commands.html#comm">SPPARKS Commands</A> 
</CENTER>






<HR>

<H3>app_style additive/thermal command 
</H3>
<P><B>Syntax:</B>
</P>
<PRE>app_style additive/thermal nspins velocity time_step path_file_name spot_x_deviation spot_y_deviation spot_z_deviation short_pause_time flux_prefactor substrate_height nsmooth dx 
</PRE>
<LI>nspins = number of spins/grain IDs  

<LI>vel = Velocity of laser travel (in meters/second) 

<LI>time_step = Finite difference solver timestep (in seconds) 

<LI>path_file_name = Name of the input file with the proposed scan path   

<LI>spot_x_deviation = X-direction standard deviation for the Gaussian laser source (in meters) 

<LI>spot_y_deviation = Y-direction standard deviation for the Gaussian laser source (in meters) 

<LI>spot_z_deviation = Z-direction standard deviation for the Gaussian laser source (in meters) 

<LI>short_wait_time = How long to turn the laser off between rasters within a layer, estimated by laser "jump" speed * distance (in seconds) 

<LI>flux_prefactor = Total absorbed laser power, typically less than incident laser power due to losses (in Watts) 

<LI>substrate_height = Baseplate thickness (in voxels) 

<LI>nsmooth = How many Potts smoothing steps to perform after a site solidifies 

<LI>dx = Lattice spacing (in meters) 


</UL>
<PRE><B>Examples:</B>
app_style additive/thermal 1000000 1.4 7e-7 "path.txt" 6e-5 6e-5 6e-5 2e-7 115 18 1 5e-6 
</PRE>
<P><B>Description:</B>
</P>
<P>This is an on-lattice application for the simulation of microstructure
formation during powder bed metal additive manufacturing (AM). Unlike the Potts model-based solidification
applications in SPPARKS, this application uses material specific solidification
parameters along with a finite-difference based thermal diffusion model. Thus,
this application can be tailored to specific materials and processes but
requires more computational resources due to the finite-difference solver. The application
is capable of simulating complex raster patterns and boundary effects.
</P>
<P>The <A HREF = "app_potts.html">Potts</A> model is used to simulate solid-state grain growth after solidification. A Potts-like
approach is also used to assign grain membership after solidification. THe number of these "smoothing"
steps is defined by "nrefine". Further details about the solidification and finite difference model are described in <A HREF = "#Rodgers">Rodgers et al.</A>.
</P>
<P>The application requires the use of a "path_file" to specify the laser raster pattern.
The path_file is a text file with five columns: x,y,z coordinates, total distance traveled, and a laser on/off flag.
The path_file can either be created by hand (an example RasterMaker.py script is provided in the examples) or by adapting
G-Code generated by a slicer program (an example GCodeToPath.py script is provided in the examples). Coordinates and
distances specified in the path file are in units of lattice sites (not meters). When the simulation reaches the end of the path file, laser flux is set to zero.
If a simulation ends before completing the specified path, the remaining path is output in a file named "restart_path.txt". This is useful
on managed clusters will wall time limitations. The restart path file can be used to resume the simulation in a subsequent job.
</P>
<P>The model uses many material and process-specific parameters that are defined in the input file and are listed below with their default values.
If no parameters are defined, default values for 304L stainless steel from <A HREF = "#Johnson">Johnson et al.</A> are used. The "specific_heat" and "solid_front_commands" are
multi-value inputs that respectively define piecewise-linear and polynomial functions.
</P>
<P>The model uses real, dimensional length-scales. Lattice spacing is assumed equal in the x,y,z directions and is
defined with the <A HREF = "lattice.html">lattice</A> command. The finite difference solver's stability is dependent upon the lattice spacing and time_step used
and these values should generally satisfy the von Neumann stability criterion, (k*dt)/dx^2 < 1/2, where k is thermal conductivity. To further
ensure stability of the thermal solver and physical accuracy, the laser path should be specified to provide a buffer from the simulation domain boundaries of at
least ~10 lattice sites. A larger buffer may be required due to the lattice spacing or melt pool dimensions.
</P>
<P>In an AM build, the laser heat source is typically turned off as the laser moves between rasters within a layer and between layers during recoating cycles.
The "short_wait_time" parameter defines how long the laser is turned off within a layer and is typically on the order of microseconds. Recoating time
is implemented by waiting until the maximum temperature in the domain is below the liquidus and then "fast forwarding" to the next layer. This avoids
simulating the entire experimental recoating time, which is on the order of seconds.
</P>
<P>As with other SPPARKS apps, the total simulation time is defined by the "run" command in the input file. This run time is independent of the time required
to complete the laser pattern specified by the "path_file". The simulation run time can be estimated by dividing the final total distance traveled
value in the "path_file" by the laser velocity. The actual run time will be slightly larger than this value due to the wait times between rasters and layers. 
</P>
<HR>

<P>The following additional commands are defined by this application:
</P>
<LI>k_solid                 = Solid conductivity (in W/(mK)) 

<LI>k_powder                = Powder conductivity (in W/(mK)) 

<LI>boundary_temperature    = Simulation volume boundary temperature (in K) 

<LI>specific_heat           = Piecewise-linear representation of specific heat. First number specifies the number of temperature/specific heat value pairs.
Remaining numbers are temperature (in Kelvin) and specific heat (in J/kg) value pairs. 

<LI>latent_heat             = Latent heat (in Kelvin) 

<LI>density                 = Use a value between full-solid density and powder density (in kg/m^3) 

<LI>t_room                  = T_room and T_inf for convection/radiation BCs (in Kelvin) 

<LI>emissivity              = Combined emissivity and stefan boltzmann constant 

<LI>convection_coefficient  = Convection coefficient (in W/m^2 K) 

<LI>Ko                      = Grain coarsening pre-factor 

<LI>Q                       = Grain coarsening exponent 

<LI>liquidus                = Liquidus temperature (in Kelvin) 

<LI>solidus                 = Solidus temperature (in Kelvin) 

<LI>solid_front_vel         = Temperature dependent polynomial solidification front velocity equation. The first number specifies number of terms
while remaining numbers are coefficient values. 

<LI>nucleation_density      = Nucleation site density (in number/m^3) 

<LI>critical_undercooling   = Center of normal distribution that defines undercooling where nucleation starts (in Kelvin) 

<LI>undercooling_deviation  = Std deviation of critical undercooling distribution (in Kelvin). 

<LI>mean_nuclei_volume      = Center of normal distribution that defines nuclei size (in m^3) 

<LI>nuclei_volume_deviation = Std dev of nuclei size distribution (in m^2) 

<P>The examples/additive_thermal directory has input files which illustrates
use of these additional commands.
</P>
<HR>

<A NAME = "restriction"></A><B>Restrictions:</B> 

<P>This application is only compatible with square cubic lattices. 
</P>
<P>This application can only be evolved by a rejection KMC (rKMC)
algorithm.  See the <A HREF = "sweep.html">sweep</A> command for more details.
</P>
<P>Due to the global nature of the finite difference method, this application cannot be used
with stitch-based domain decomposition. However, the <A HREF = "set.html">set stitch</A> and <A HREF = "dump.html">dump stitch</A>
commands can be used to read/write the entire simulation domain.
</P>
<P><B>Related commands:</B>
</P>
<P><A HREF = "app_potts_weld.html">app_style potts/weld</A>,
<A HREF = "app_potts_weld_jom.html">app_style potts/weld/jom</A>,
<A HREF = "app_potts_additive.html">app_style potts/additive</A>,
<A HREF = "app_potts.html">app_style potts</A>
</P>
<P><B>Default:</B> 
</P>
<LI>k_solid                 30  

<LI>k_powder                0.3  

<LI>boundary_temperature    300  

<LI>specific_heat           6 300 480 600 550 1400 675 1550 693 1650 714 1750 736 

<LI>latent_heat             285000  

<LI>density                 5706  

<LI>t_room                  300  

<LI>emissivity              1  

<LI>convection_coefficient  25 

<LI>Ko                      0.0000204133  

<LI>Q                       128312  

<LI>liquidus                1723  

<LI>solidus                 1673  

<LI>solid_front_vel         4 1.091e-5 -2.034e-4 2.74e-3 1.151e-4  

<LI>nucleation_density      1e14 

<LI>critical_undercooling   5 

<LI>undercooling_deviation  3  

<LI>mean_nuclei_volume      8.4375e-16  

<LI>nuclei_volume_deviation 1.5625e-17 

<HR>

<A NAME = "Rodgers"></A>

<P><B>(Rodgers)</B> T.M. Rodgers, D. Moser, F. Abdeljawad, O.D. Underwood Jackson, J.D. Carroll, B.H. Jared, D.S. Bolintineanu, J.A. Mitchell, J. D.Madison, "Simulation of Powder Bed Metal Additive Manufacturing Microstructures with Coupled Finite Difference-Monte Carlo Method", Additive Manufacturing (2021).
</P>
<A NAME = "Johnson"></A>

<P><B>(Johnson)</B> K.L. Johnson, T.M. Rodgers, O.D. Underwood, J.D. Madison, K.R. Ford, S.R. Whetten, D.J. Dagel, J.E. Bishop, "Simulation and experimental comparison of the thermo-mechanical history and 3D microstructure evolution of 304L stainless steel tubes manufactured using LENS", Computational Mechanics (2018).</P>
</HTML>
